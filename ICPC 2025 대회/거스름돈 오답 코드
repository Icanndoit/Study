#include<iostream>
#include<map>
using namespace std;

int main() {
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	int n;
	cin >> n;

	for (int i = 1; i <= n; i++) {
		map<int, int>hash;
		hash[500] = hash[1000] = 0;   // 처음에는 거스름돈을 가지고 있지 않는다.
		int len, out = 0;  cin >> len;
		int* list = new int[len];
		int j = 0;
		for (j = 0; j < len; j++)
			cin >> list[j];

		bool boolean = true;
		j = 0;
		while (j < len || boolean) {
			if (list[j] != 500 && list[j] != 1000)
				boolean = false;
			else if (list[j] == 500) {
				hash[500] += 1;
				out++;
			}
			else if (list[j] == 1000) {
				if (hash[500] == 0)
					boolean = false;
				else {
					hash[1000] += 1;
					hash[500] -= 1;
					out++;
				}
			}
			j++;
		}

		cout << "Case #" << i << endl;
		cout << out << endl;
		delete[] list;
	}

	return 0;
}
